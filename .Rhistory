tmp <- cbind(tmp, x$data$public_metrics)
tmp.1 <- list()
for (i in 1:nrow(x$data)){
url_t.co <- x$data$entities$urls[[i]][[3]]
if(length(url_t.co)==0){
url_t.co <- NA
} else {
url_t.co <- url_t.co
}
tmp.1[[i]] <- url_t.co
}
tmp$url_t.co <- tmp.1
tmp.1 <- list()
for (i in 1:nrow(x$data)){
url_extended_url<- x$data$entities$urls[[i]][[4]]
if(length(url_extended_url)==0){
url_extended_url <- NA
} else {
url_extended_url <- url_extended_url
}
tmp.1[[i]] <- url_extended_url
}
tmp$url_extended_url <- tmp.1
tmp.1 <- list()
for (i in 1:nrow(x$data)){
hashtags <- x$data$entities$hashtags[[i]][[3]]
if(length(hashtags) == 0){
hashtags <- NA
} else{
hashtags <- hashtags
}
tmp.1[[i]] <- hashtags
}
tmp$hashtags <- tmp.1
tmp.1 <- list()
for (i in 1:nrow(x$data)){
mentions_screen_name <- x$data$entities$mentions[[i]][[3]]
if(length(mentions_screen_name)==0){
mentions_screen_name <- NA
}  else {
mentions_screen_name <- mentions_screen_name
}
tmp.1[[i]] <- mentions_screen_name
}
tmp$mentions_screen_name <- tmp.1
names(x$includes$users)[names(x$includes$users) == "id"] <- "author_id"
df <- left_join(x$data, x$includes$users, by = "author_id")
## follower count, following count, tweet count, listed_count
tmp$screen_name <-df$username
tmp <- cbind(tmp, df$public_metrics.y)
tmp$profile_image_url <-df$profile_image_url
tmp$name <-df$name
tmp$location <-df$location
tmp$description <-df$description
tmp$verified <-df$verified
tmp$profile_image_url <-df$profile_image_url
tmp$account_created_at <-df$created_at.y
tmp.2 <- list()
for (i in 1:length(df$entities.y$url$urls)){
profile_url <- df$entities.y$url$urls[[1]][[4]]
if(length(profile_url)==0){
profile_url <- NA
} else {
profile_url <- profile_url
}
tmp.2[[i]] <- data.frame(profile_url)
}
tmp.2 <- do.call(rbind.data.frame, tmp.2)
tmp$profile_url <- tmp.2
names(x$includes$places)[names(x$includes$places) == "id"] <- "place_id"
x$includes$places <- subset(x$includes$places, select = -geo )
tmp <- left_join(tmp, x$includes$places, by = "place_id")
tmp
tweets_list_clean <- lapply(list, function(x){
##from x$data
selec_col <- c("created_at","id","text","lang","author_id", "source","conversation_id")
tmp <- x$data[selec_col]
for(i in 1:nrow(x$data)){
if("in_reply_to_user_id" %in% colnames(x$data) == TRUE){
in_reply_to_user_id <- x$data$in_reply_to_user_id
}else{
in_reply_to_user_id <- NA}
}
tmp$in_reply_to_user_id <- in_reply_to_user_id
tmp$geo_coords <- x$data$geo$coordinates$coordinates
tmp$place_id <- x$data$geo$place_id
tmp$context_annotations <- x$data$context_annotations
tmp <- cbind(tmp, x$data$public_metrics)
tmp.1 <- list()
for (i in 1:nrow(x$data)){
url_t.co <- x$data$entities$urls[[i]][[3]]
if(length(url_t.co)==0){
url_t.co <- NA
} else {
url_t.co <- url_t.co
}
tmp.1[[i]] <- url_t.co
}
tmp$url_t.co <- tmp.1
tmp.1 <- list()
for (i in 1:nrow(x$data)){
url_extended_url<- x$data$entities$urls[[i]][[4]]
if(length(url_extended_url)==0){
url_extended_url <- NA
} else {
url_extended_url <- url_extended_url
}
tmp.1[[i]] <- url_extended_url
}
tmp$url_extended_url <- tmp.1
tmp.1 <- list()
for (i in 1:nrow(x$data)){
hashtags <- x$data$entities$hashtags[[i]][[3]]
if(length(hashtags) == 0){
hashtags <- NA
} else{
hashtags <- hashtags
}
tmp.1[[i]] <- hashtags
}
tmp$hashtags <- tmp.1
tmp.1 <- list()
for (i in 1:nrow(x$data)){
mentions_screen_name <- x$data$entities$mentions[[i]][[3]]
if(length(mentions_screen_name)==0){
mentions_screen_name <- NA
}  else {
mentions_screen_name <- mentions_screen_name
}
tmp.1[[i]] <- mentions_screen_name
}
tmp$mentions_screen_name <- tmp.1
## from user data
names(x$includes$users)[names(x$includes$users) == "id"] <- "author_id"
df <- left_join(x$data, x$includes$users, by = "author_id")
## follower count, following count, tweet count, listed_count
tmp$screen_name <-df$username
tmp <- cbind(tmp, df$public_metrics.y)
tmp$profile_image_url <-df$profile_image_url
tmp$name <-df$name
tmp$location <-df$location
tmp$description <-df$description
tmp$verified <-df$verified
tmp$profile_image_url <-df$profile_image_url
tmp$account_created_at <-df$created_at.y
tmp.2 <- list()
for (i in 1:length(df$entities.y$url$urls)){
profile_url <- df$entities.y$url$urls[[1]][[4]]
if(length(profile_url)==0){
profile_url <- NA
} else {
profile_url <- profile_url
}
tmp.2[[i]] <- data.frame(profile_url)
}
tmp.2 <- do.call(rbind.data.frame, tmp.2)
tmp$profile_url <- tmp.2
names(x$includes$places)[names(x$includes$places) == "id"] <- "place_id"
x$includes$places <- subset(x$includes$places, select = -geo )
tmp <- left_join(tmp, x$includes$places, by = "place_id")
tmp
})
lengh
length(tweets_list_april)
list[[i]]
tweets_list_clean <- list()
for(i in 1:length(list)){
x <- list[[i]]
#tweets_list_clean <- lapply(list, function(x){
##from x$data
selec_col <- c("created_at","id","text","lang","author_id", "source","conversation_id")
tmp <- x$data[selec_col]
for(i in 1:nrow(x$data)){
if("in_reply_to_user_id" %in% colnames(x$data) == TRUE){
in_reply_to_user_id <- x$data$in_reply_to_user_id
}else{
in_reply_to_user_id <- NA}
}
tmp$in_reply_to_user_id <- in_reply_to_user_id
tmp$geo_coords <- x$data$geo$coordinates$coordinates
tmp$place_id <- x$data$geo$place_id
tmp$context_annotations <- x$data$context_annotations
tmp <- cbind(tmp, x$data$public_metrics)
tmp.1 <- list()
for (i in 1:nrow(x$data)){
url_t.co <- x$data$entities$urls[[i]][[3]]
if(length(url_t.co)==0){
url_t.co <- NA
} else {
url_t.co <- url_t.co
}
tmp.1[[i]] <- url_t.co
}
tmp$url_t.co <- tmp.1
tmp.1 <- list()
for (i in 1:nrow(x$data)){
url_extended_url<- x$data$entities$urls[[i]][[4]]
if(length(url_extended_url)==0){
url_extended_url <- NA
} else {
url_extended_url <- url_extended_url
}
tmp.1[[i]] <- url_extended_url
}
tmp$url_extended_url <- tmp.1
tmp.1 <- list()
for (i in 1:nrow(x$data)){
hashtags <- x$data$entities$hashtags[[i]][[3]]
if(length(hashtags) == 0){
hashtags <- NA
} else{
hashtags <- hashtags
}
tmp.1[[i]] <- hashtags
}
tmp$hashtags <- tmp.1
tmp.1 <- list()
for (i in 1:nrow(x$data)){
mentions_screen_name <- x$data$entities$mentions[[i]][[3]]
if(length(mentions_screen_name)==0){
mentions_screen_name <- NA
}  else {
mentions_screen_name <- mentions_screen_name
}
tmp.1[[i]] <- mentions_screen_name
}
tmp$mentions_screen_name <- tmp.1
## from user data
names(x$includes$users)[names(x$includes$users) == "id"] <- "author_id"
df <- left_join(x$data, x$includes$users, by = "author_id")
## follower count, following count, tweet count, listed_count
tmp$screen_name <-df$username
tmp <- cbind(tmp, df$public_metrics.y)
tmp$profile_image_url <-df$profile_image_url
tmp$name <-df$name
tmp$location <-df$location
tmp$description <-df$description
tmp$verified <-df$verified
tmp$profile_image_url <-df$profile_image_url
tmp$account_created_at <-df$created_at.y
tmp.2 <- list()
for (i in 1:length(df$entities.y$url$urls)){
profile_url <- df$entities.y$url$urls[[1]][[4]]
if(length(profile_url)==0){
profile_url <- NA
} else {
profile_url <- profile_url
}
tmp.2[[i]] <- data.frame(profile_url)
}
tmp.2 <- do.call(rbind.data.frame, tmp.2)
tmp$profile_url <- tmp.2
names(x$includes$places)[names(x$includes$places) == "id"] <- "place_id"
x$includes$places <- subset(x$includes$places, select = -geo )
tmp <- left_join(tmp, x$includes$places, by = "place_id")
tmp
}
i
x <- list[[i]]
#tweets_list_clean <- lapply(list, function(x){
##from x$data
selec_col <- c("created_at","id","text","lang","author_id", "source","conversation_id")
tmp <- x$data[selec_col]
for(i in 1:nrow(x$data)){
if("in_reply_to_user_id" %in% colnames(x$data) == TRUE){
in_reply_to_user_id <- x$data$in_reply_to_user_id
}else{
in_reply_to_user_id <- NA}
}
tmp$in_reply_to_user_id <- in_reply_to_user_id
tmp$geo_coords <- x$data$geo$coordinates$coordinates
tmp$place_id <- x$data$geo$place_id
tmp$context_annotations <- x$data$context_annotations
tmp <- cbind(tmp, x$data$public_metrics)
tmp.1 <- list()
for (i in 1:nrow(x$data)){
url_t.co <- x$data$entities$urls[[i]][[3]]
if(length(url_t.co)==0){
url_t.co <- NA
} else {
url_t.co <- url_t.co
}
tmp.1[[i]] <- url_t.co
}
tmp$url_t.co <- tmp.1
tmp.1 <- list()
for (i in 1:nrow(x$data)){
url_extended_url<- x$data$entities$urls[[i]][[4]]
if(length(url_extended_url)==0){
url_extended_url <- NA
} else {
url_extended_url <- url_extended_url
}
tmp.1[[i]] <- url_extended_url
}
x$data$entities$urls[[1]]
x$data$entities$urls
View(x$data$entities$urls)
x$data$entities$urls[[i]][[3]]
i
i= 1
x$data$entities$urls[[i]][[3]]
url_t.co <- x$data$entities$urls[[i]][[3]]
length(url_t.co)
tweets_list_clean <- lapply(list, function(x){
##from x$data
selec_col <- c("created_at","id","text","lang","author_id", "source","conversation_id")
tmp <- x$data[selec_col]
for(i in 1:nrow(x$data)){
if("in_reply_to_user_id" %in% colnames(x$data) == TRUE){
in_reply_to_user_id <- x$data$in_reply_to_user_id
}else{
in_reply_to_user_id <- NA}
}
tmp$in_reply_to_user_id <- in_reply_to_user_id
tmp$geo_coords <- x$data$geo$coordinates$coordinates
tmp$place_id <- x$data$geo$place_id
tmp$context_annotations <- x$data$context_annotations
tmp <- cbind(tmp, x$data$public_metrics)
tmp.1 <- list()
for (i in 1:nrow(x$data)){
url_t.co <- x$data$entities$urls[[i]][[3]]
if(length(url_t.co)==0){
url_t.co <- NA
} else {
url_t.co <- url_t.co
}
tmp.1[[i]] <- url_t.co
}
tmp$url_t.co <- tmp.1
tmp.2 <- list()
for (j in 1:nrow(x$data)){
url_extended_url<- x$data$entities$urls[[j]][[4]]
if(length(url_extended_url)==0){
url_extended_url <- NA
} else {
url_extended_url <- url_extended_url
}
tmp.2[[j]] <- url_extended_url
}
tmp$url_extended_url <- tmp.2
tmp.3 <- list()
for (k in 1:nrow(x$data)){
hashtags <- x$data$entities$hashtags[[k]][[3]]
if(length(hashtags) == 0){
hashtags <- NA
} else{
hashtags <- hashtags
}
tmp.3[[k]] <- hashtags
}
tmp$hashtags <- tmp.3
tmp.4 <- list()
for (n in 1:nrow(x$data)){
mentions_screen_name <- x$data$entities$mentions[[n]][[3]]
if(length(mentions_screen_name)==0){
mentions_screen_name <- NA
}  else {
mentions_screen_name <- mentions_screen_name
}
tmp.4[[n]] <- mentions_screen_name
}
tmp$mentions_screen_name <- tmp.4
## from user data
names(x$includes$users)[names(x$includes$users) == "id"] <- "author_id"
df <- left_join(x$data, x$includes$users, by = "author_id")
## follower count, following count, tweet count, listed_count
tmp$screen_name <-df$username
tmp <- cbind(tmp, df$public_metrics.y)
tmp$profile_image_url <-df$profile_image_url
tmp$name <-df$name
tmp$location <-df$location
tmp$description <-df$description
tmp$verified <-df$verified
tmp$profile_image_url <-df$profile_image_url
tmp$account_created_at <-df$created_at.y
tmp.5 <- list()
for (m in 1:length(df$entities.y$url$urls)){
profile_url <- df$entities.y$url$urls[[m]][[4]]
if(length(profile_url)==0){
profile_url <- NA
} else {
profile_url <- profile_url
}
tmp.5[[m]] <- data.frame(profile_url)
}
tmp.5 <- do.call(rbind.data.frame, tmp.5)
tmp$profile_url <- tmp.5
names(x$includes$places)[names(x$includes$places) == "id"] <- "place_id"
x$includes$places <- subset(x$includes$places, select = -geo )
tmp <- left_join(tmp, x$includes$places, by = "place_id")
return(tmp)
})
tmp.5 <- list()
for (m in 1:length(df$entities.y$url$urls)){
profile_url <- df$entities.y$url$urls[[m]][[4]]
if(length(profile_url)==0){
profile_url <- NA
} else {
profile_url <- profile_url
}
tmp.5[[m]] <- data.frame(profile_url)
}
m
df
View(df)
length(df$entities.y$url$urls)
df$entities.y$url$urls[[m]][[4]]
df$entities.y$url$urls[[1]][[4]]
df$entities.y$url$urls
View(df$entities.y$url$urls)
df$entities.y$url$urls[[1]][["url"]]
df$entities.y$url$urls[[2]][["url"]]
df$entities.y$url$urls[[3]][["url"]]
tweets_list_clean <- lapply(list, function(x){
##from x$data
selec_col <- c("created_at","id","text","lang","author_id", "source","conversation_id")
tmp <- x$data[selec_col]
for(i in 1:nrow(x$data)){
if("in_reply_to_user_id" %in% colnames(x$data) == TRUE){
in_reply_to_user_id <- x$data$in_reply_to_user_id
}else{
in_reply_to_user_id <- NA}
}
tmp$in_reply_to_user_id <- in_reply_to_user_id
tmp$geo_coords <- x$data$geo$coordinates$coordinates
tmp$place_id <- x$data$geo$place_id
tmp$context_annotations <- x$data$context_annotations
tmp <- cbind(tmp, x$data$public_metrics)
tmp.1 <- list()
for (i in 1:nrow(x$data)){
url_t.co <- x$data$entities$urls[[i]][[3]]
if(length(url_t.co)==0){
url_t.co <- NA
} else {
url_t.co <- url_t.co
}
tmp.1[[i]] <- url_t.co
}
tmp$url_t.co <- tmp.1
tmp.2 <- list()
for (j in 1:nrow(x$data)){
url_extended_url<- x$data$entities$urls[[j]][[4]]
if(length(url_extended_url)==0){
url_extended_url <- NA
} else {
url_extended_url <- url_extended_url
}
tmp.2[[j]] <- url_extended_url
}
tmp$url_extended_url <- tmp.2
tmp.3 <- list()
for (k in 1:nrow(x$data)){
hashtags <- x$data$entities$hashtags[[k]][[3]]
if(length(hashtags) == 0){
hashtags <- NA
} else{
hashtags <- hashtags
}
tmp.3[[k]] <- hashtags
}
tmp$hashtags <- tmp.3
tmp.4 <- list()
for (n in 1:nrow(x$data)){
mentions_screen_name <- x$data$entities$mentions[[n]][[3]]
if(length(mentions_screen_name)==0){
mentions_screen_name <- NA
}  else {
mentions_screen_name <- mentions_screen_name
}
tmp.4[[n]] <- mentions_screen_name
}
tmp$mentions_screen_name <- tmp.4
## from user data
names(x$includes$users)[names(x$includes$users) == "id"] <- "author_id"
df <- left_join(x$data, x$includes$users, by = "author_id")
## follower count, following count, tweet count, listed_count
tmp$screen_name <-df$username
tmp <- cbind(tmp, df$public_metrics.y)
tmp$profile_image_url <-df$profile_image_url
tmp$name <-df$name
tmp$location <-df$location
tmp$description <-df$description
tmp$verified <-df$verified
tmp$profile_image_url <-df$profile_image_url
tmp$account_created_at <-df$created_at.y
tmp.5 <- list()
for (m in 1:length(df$entities.y$url$urls)){
profile_url <- df$entities.y$url$urls[[m]][["url"]]
if(length(profile_url)==0){
profile_url <- NA
} else {
profile_url <- profile_url
}
tmp.5[[m]] <- data.frame(profile_url)
}
tmp.5 <- do.call(rbind.data.frame, tmp.5)
tmp$profile_url <- tmp.5
names(x$includes$places)[names(x$includes$places) == "id"] <- "place_id"
x$includes$places <- subset(x$includes$places, select = -geo )
tmp <- left_join(tmp, x$includes$places, by = "place_id")
return(tmp)
})
x$data$entities$urls[[i]]
x$data$entities$urls[[2]]
x$data$entities$urls[[2]][["url"]]
x$data$entities$urls[[2]][["expanded_url"]]
x$data$entities$hashtags[[1]]
x$data$entities$hashtags[[2]]
x$data$entities$mentions[[1]]
x$data$entities$mentions[[1]][["username"]]
x$data$entities$mentions[[1]][[3]]
